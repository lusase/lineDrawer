<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="https://cdn.bootcdn.net/ajax/libs/fabric.js/5.3.1/fabric.js"></script>
  <script src="../node_modules/tinycolor2/tinycolor.js"></script>
</head>
<body>

<div style="color: #fff">
  <span style="background: aqua   ">aqua 水绿色</span>
  <span style="background: fuchsia">fuchsia 紫红色</span>
  <span style="background: lime   ">lime 黄绿色</span>
  <span style="background: maroon ">maroon 红褐色</span>
  <span style="background: navy   ">navy 藏青色</span>
  <span style="background: olive  ">olive 黄褐色</span>
  <span style="background: silver ">silver 银色</span>
  <span style="background: teal   ">teal 蓝绿色</span>
  <span style="background: purple ">purple 紫色</span>
  <span style="background: orange ">orange 橘黄色</span>
</div>
<div style="margin: 20px;width: 1920px;height: 480px;background: #ccc;display: flex;">
  <canvas id="c" width="640" height="480"></canvas>
  <canvas id="d" width="640" height="480" style="margin-left: 80px;"></canvas>
</div>

<button style="margin-top: 30px" onclick="addNewLine()">新建线条</button>
<button style="margin-top: 30px" onclick="delCurrentDot()">删除选中的点</button>
<button style="margin-top: 30px" onclick="delCurrentLine()">删除选中的线条</button>
<button style="margin-top: 30px" onclick="saveCanvas()">保存</button>
<button style="margin-top: 30px" onClick="toggleEditable()">可拖动/不可拖动</button>
<button style="margin-top: 30px" onClick="toggleRecover()">恢复</button>
<button style="margin-top: 30px" onClick="setDrawType('line')">画线</button>
<button style="margin-top: 30px" onClick="setDrawType('polygon')">画多边形</button>
<div>
  颜色 <input id="color">
  <button onclick="setLineColor()">保存颜色</button>
</div>
<div>
  宽度 <input id="width">
  <button onclick="setLineWidth()">保存宽度</button>
</div>
<script>
  fabric.fabric = fabric
  // window.w$1 = tinycolor
</script>
<script src="../dist/linedrawer.js"></script>
<script>
  const drawer = new LineDrawer.GraphicDrawer('c', {
    lineStroke: '#fff',
    strokeWidth: 2,
    editable: true,
    pathOpacity: 0.5,
    bgUrl: './bg.jpg',
    fill: '#1890ff',
    fills: ['red', 'blue', 'yellow'],
    textStyle: {
      visible: true
    }
  })
  drawer.addData(
    {
      drawType: 'polygon', graphics: [{
        id: '1',
        name: '你好, Tom',
        path: [{x: 0.1, y: 0.1}, {x: 0.1, y: 0.2}, {x: 0.2, y: 0.1}]
      }, {
        id: '2',
        name: '名字特别的长, 躲到树后面也会被发现',
        path: [{x: 0.2, y: 0.1}, {x: 0.3, y: 0.2}, {x: 0.5, y: 0.1}]
      }]
    }
  )
  drawer.addData({
    drawType: 'line',
    graphics: [{
      id: '3',
      name: 'hello',
      path: [{x: 0.6, y: 0.4}, {x: 0.8, y: 0.3}, {x: 0.7, y: 0.8}]
    }]
  })
  drawer.on('graph.click', e => console.log(e))

  function toggleEditable() {
    drawer.setConfig({
      editable: !drawer.config.editable
    })
  }

  function toggleRecover() {
    drawer.recover()
  }

  function setDrawType(type) {
    drawer.setDrawType(type)
  }
</script>

<script>
  /*const canvas = new fabric.Canvas('d')
  const rect = new fabric.Rect({
    left: 100,
    top: 100,
    width: 100,
    height: 100,
    fill: 'red',
  })
  const rect2 = new fabric.Rect({
    left: 150,
    top: 150,
    width: 100,
    height: 100,
    fill: 'blue'
  })
  canvas.add(rect, rect2)
  console.log(canvas)
  setTimeout(() => {
    rect2.sendToBack()
    rect2.set({selected: false})
  }, 5000)*/
</script>
</body>
</html>
